# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb234/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb234/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.12614929976, 0.12614929976,0.120057533893,0.12614929976,0.120069389497,0.0437450581036,0.0346694388033,0.0365956955661,0.0390478699417,0.0401228512476,0.0409810327139,0.0390478699417,0.0390478699417,0.0390478699417,0.0415501031749,0.0353125285515,0.0473896234074,0.0505092172957,0.0512233724459,0.0513061644868,0.0535204806319,0.0741177114871,0.0834615388019,0.0840832524567,0.0880021598053,0.0880021598053,0.0880021598053,0.0882943797251,0.0882943797251,0.0882943797251,0.0841908793042,0.101176454481,0.114497533294,0.133152023884,0.137325133803,0.141056243099,0.12961491454,0.12820544276,0.123444684697,0.117160984983,0.117639386659,0.11709991868,0.114497533294,0.107311321804,0.100342285002,0.0958258131052,0.0885958419764,0.0874825644705,0.0818331425924,0.067924487056,0.0728602057744,0.068378162361,0.067924487056,0.067924487056,0.067924487056)
L_hpd_M95=c(0.338793851963, 0.338793851963,0.332556119512,0.339032791081,0.338793851963,0.316724987981,0.210503848234,0.12751477887,0.12751477887,0.127206278441,0.127373424089,0.124791887679,0.124292217232,0.124292217232,0.127206278441,0.127030052731,0.151427997405,0.155158872456,0.15616746317,0.161159233124,0.188458013816,0.212537289281,0.215939944588,0.214267471202,0.216674701468,0.216134834777,0.216134834777,0.217274078207,0.220013333952,0.236833588785,0.294579889214,0.367641691952,0.411653852917,0.445990190104,0.457780671066,0.46106031859,0.449965786002,0.446908953492,0.443974577911,0.439803775234,0.439223621167,0.441117411155,0.442969228412,0.439803775234,0.437392193183,0.439803775234,0.433162121591,0.434785123248,0.440211089646,0.439223621167,0.455129936853,0.452715341772,0.45398805136,0.45398805136,0.45398805136)
M_hpd_m95=c(0.868339478248, 0.868339478248,0.0792516581159,0.0821877048111,0.0826814138269,0.0818002273889,0.082262078589,0.0705022181068,0.0657780965927,0.0703123406701,0.0703123406701,0.070680496218,0.0705429662843,0.071687193406,0.071687193406,0.071687193406,0.0702785713721,0.0703154142856,0.0702785713721,0.0675955809153,0.0679500204026,0.0655579561578,0.0603725365095,0.0592760915817,0.0569526582179,0.0569526582179,0.0569526582179,0.0527091969617,0.0525641525082,0.0526309858856,0.0502685704244,0.0491798550595,0.0482580565227,0.047912484697,0.047912484697,0.0478303510204,0.047912484697,0.0478303510204,0.0427354276962,0.0393517223262,0.0362054747068,0.035315039196,0.0307135139303,0.0311711762935,0.0307135139303,0.0307135139303,0.0307135139303,0.0307135139303,0.0307135139303,0.0307135139303,0.0307135139303,0.0307135139303,0.0307135139303,0.0307135139303,0.0307135139303)
M_hpd_M95=c(1.50425944437, 1.50425944437,0.213438424701,0.213438424701,0.214384903993,0.213438424701,0.213438424701,0.184742278191,0.138413193543,0.129039192694,0.1268468063,0.126727463641,0.126253569029,0.1268468063,0.126727463641,0.126672246433,0.124225788672,0.123622177228,0.123766459381,0.121365850449,0.121365850449,0.12027569221,0.116991423915,0.115538266857,0.113661799046,0.114474650528,0.115104386088,0.111437199692,0.11154842404,0.112550000795,0.111345512059,0.111345512059,0.111437199692,0.112550000795,0.113483350418,0.113483350418,0.115551834127,0.120534773844,0.119610848516,0.119165824238,0.118358978865,0.125005603448,0.132858918544,0.144274915406,0.152993668583,0.152993668583,0.152993668583,0.152993668583,0.152993668583,0.152993668583,0.152993668583,0.152993668583,0.152993668583,0.152993668583,0.152993668583)
R_hpd_m95=c(-1.27473335021, -1.27473335021,0.00907243898821,0.00907243898821,0.00587463575534,-0.115608753667,-0.168341399731,-0.137539907845,-0.0845428116228,-0.0688186921438,-0.0712728212181,-0.0660640630795,-0.0710881339035,-0.0710881339035,-0.0712728212181,-0.0701773991311,-0.0615977415006,-0.0586489176562,-0.0577486154568,-0.0577486154568,-0.0523117706616,-0.0213305688401,-0.0175498694967,-0.0133730099809,-0.00866049306601,-0.00403213933877,-0.00252488975655,-8.6390748971e-05,-0.00285879583097,-0.00771744494855,-0.0185075321655,0.0110751686304,0.0265950717823,0.038212392535,0.0435920245319,0.0476120822608,0.0461465858526,0.0462052623914,0.0452673529513,0.0344808904599,0.0326740273032,0.0187609199482,0.0173995774516,0.0059645888044,0.0110413168901,-0.013957622101,-0.0156280430575,-0.0156280430575,-0.0156280430575,-0.0156280430575,-0.0156280430575,-0.0156280430575,-0.0156280430575,-0.0156280430575,-0.0156280430575)
R_hpd_M95=c(-0.593527573918, -0.593527573918,0.238724610978,0.233154743317,0.238724610978,0.231426889912,0.0989266573634,0.0351371245572,0.0396893935488,0.0396893935488,0.0347228050647,0.0391141300193,0.0326628819918,0.0326628819918,0.0326628819918,0.0394490956606,0.060407991392,0.0668243092035,0.0676166220664,0.0712495161606,0.0973862843605,0.123541293225,0.126685365094,0.132410952343,0.138610999007,0.143042706176,0.143042706176,0.14667400193,0.145910950911,0.164935097651,0.215325744227,0.287175727723,0.334135942189,0.362247444982,0.373474958221,0.371608262456,0.371608262456,0.370995978926,0.371608262456,0.370995978926,0.371608262456,0.362247444982,0.368316473203,0.370987751463,0.385646170231,0.363726559783,0.361183996328,0.361183996328,0.371608262456,0.385768021557,0.395763004074,0.401832256951,0.405362803496,0.405362803496,0.405362803496)
L_mean=c(0.260146839069, 0.260146839069,0.260192723553,0.260200402386,0.258040696601,0.191599267568,0.0858863977655,0.0771880325082,0.0764372507472,0.0760015874838,0.0757788933802,0.0755831003738,0.0755541825426,0.0756393053532,0.0757657722782,0.0772791337617,0.0887845893648,0.0919461043885,0.092574014572,0.0957825591186,0.117204842217,0.146333558063,0.150158069072,0.15357963426,0.155296567903,0.155508691527,0.155383413916,0.155519105115,0.156428644014,0.162022459355,0.177863172917,0.211062131244,0.24924025242,0.270640969615,0.283541402054,0.284183555159,0.282088236818,0.281966371605,0.281068495295,0.277150688511,0.275228191429,0.273726407966,0.273106321773,0.271988398448,0.271301379479,0.267966928978,0.265256957098,0.264940268266,0.265051429587,0.261260640296,0.259850348853,0.259532200127,0.259876771986,0.259934704886,0.259938453996)
M_mean=c(1.19897999648, 1.19897999648,0.12626104364,0.130385225384,0.130691507137,0.130478152116,0.129267612822,0.113238025167,0.101709680439,0.0982027603496,0.0978366066524,0.0976745005903,0.0976677815626,0.0975684525799,0.0974882235653,0.0973606729908,0.0965235193845,0.096054528943,0.0958449314189,0.0959503445254,0.0956397030907,0.0932814890681,0.0903188689848,0.0897116603531,0.08864455354,0.0867689735555,0.0861220785159,0.08528520754,0.084913169704,0.0844480750642,0.0839163002347,0.0834487991838,0.0832077273076,0.0835011599845,0.0835523760549,0.0835708424568,0.0836665302693,0.0839931405882,0.0840367956869,0.0842560840354,0.0844260782323,0.0858454438983,0.0869025390616,0.0884204506407,0.088989675058,0.0889972099164,0.0889972099164,0.0889972099164,0.0889972099164,0.0889972099164,0.0889972099164,0.0889972099164,0.0889972099164,0.0889972099164,0.0889972099164)
R_mean=c(-0.938833157414, -0.938833157414,0.133931679912,0.129815177001,0.127349189464,0.0611211154521,-0.0433812150565,-0.0360499926584,-0.0252724296913,-0.0222011728658,-0.0220577132721,-0.0220914002165,-0.0221135990199,-0.0219291472268,-0.0217224512871,-0.0200815392292,-0.00773893001974,-0.00410842455445,-0.00327091684686,-0.000167785406706,0.0215651391258,0.053052068995,0.059839200087,0.0638679739065,0.0666520143631,0.0687397179713,0.0692613353997,0.0702338975754,0.0715154743097,0.0775743842908,0.093946872682,0.12761333206,0.166032525112,0.18713980963,0.199989025999,0.200612712702,0.198421706548,0.197973231017,0.197031699608,0.192894604475,0.190802113197,0.187880964068,0.186203782712,0.183567947807,0.182311704421,0.178969719062,0.176259747181,0.17594305835,0.176054219671,0.17226343038,0.170853138936,0.170534990211,0.170879562069,0.17093749497,0.17094124408)
trans=0.5
age=(0:(55-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.507166350449), xlim = c(-57.75,2.75), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.6546853888), xlim = c(-57.75,2.75), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.40220668523, 0.445899083845), xlim = c(-57.75,2.75), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-57.75,2.75), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()