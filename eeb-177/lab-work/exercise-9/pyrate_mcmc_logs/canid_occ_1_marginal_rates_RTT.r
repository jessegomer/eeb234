# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb234/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb234/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.194000578519, 0.194000578519,0.194000578519,0.194000578519,0.0639177219189,0.056925770475,0.0297270540251,0.0390015273725,0.0297270540251,0.0297270540251,0.0297270540251,0.0297270540251,0.0297270540251,0.0297270540251,0.0297270540251,0.0297270540251,0.0418800945355,0.0507941478051,0.0507941478051,0.065608263559,0.0816500585988,0.0914996228276,0.0914996228276,0.0914996228276,0.0939028599437,0.0939028599437,0.0939028599437,0.0939028599437,0.0914996228276,0.0953825746579,0.0914996228276,0.121215805392,0.133971295691,0.133971295691,0.133971295691,0.133971295691,0.133971295691,0.133971295691,0.133971295691,0.133971295691,0.133971295691,0.133971295691,0.116382853967,0.107570891207,0.116281768642,0.107570891207,0.107570891207,0.107570891207,0.107570891207,0.107570891207,0.107570891207,0.107570891207,0.107570891207)
L_hpd_M95=c(0.405152757681, 0.405152757681,0.405152757681,0.405152757681,0.362606045329,0.354140356003,0.247920988026,0.135256399474,0.122072375071,0.122072375071,0.122072375071,0.122072375071,0.122072375071,0.122072375071,0.122072375071,0.122072375071,0.161579988842,0.183199620121,0.186776548666,0.201217529584,0.201217529584,0.209766563395,0.207293207721,0.204720666556,0.204720666556,0.204720666556,0.206649171072,0.206649171072,0.207293207721,0.221234433616,0.286623155255,0.402783082621,0.396452967572,0.396452967572,0.41580447754,0.417678097329,0.417678097329,0.417678097329,0.417678097329,0.424480780992,0.424480780992,0.427347639592,0.406563560094,0.397767241103,0.402783082621,0.397767241103,0.389880253462,0.383401420959,0.379900107554,0.379900107554,0.383401420959,0.383401420959,0.383401420959)
M_hpd_m95=c(0.818918077605, 0.818918077605,0.0890495531159,0.0890495531159,0.0890495531159,0.0839527815561,0.0839527815561,0.086684048344,0.0848583414538,0.0839527815561,0.0824756360403,0.0848583414538,0.0848583414538,0.0848583414538,0.0848583414538,0.0848583414538,0.0848583414538,0.0839527815561,0.0824756360403,0.0824756360403,0.0824756360403,0.0824756360403,0.0824756360403,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126,0.0814050773126)
M_hpd_M95=c(1.64500284907, 1.64500284907,0.250316733889,0.250316733889,0.250316733889,0.20614652787,0.167323294415,0.141258170927,0.138278716697,0.132871914899,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765,0.126956544765)
R_hpd_m95=c(-1.32773755717, -1.32773755717,-0.0304529729043,-0.0304529729043,-0.0881573075278,-0.0972692543976,-0.087632826903,-0.0876221341021,-0.0798512687203,-0.0784864133544,-0.0767999905158,-0.0784864133544,-0.0784864133544,-0.0784864133544,-0.0784864133544,-0.0784864133544,-0.0758630865531,-0.0544298105425,-0.0544298105425,-0.0422491453278,-0.0269149089352,-0.0112620452243,-0.0211637231644,-0.0198853203757,-0.0112620452243,-0.0112620452243,-0.0109024812985,-0.0109024812985,-0.0198853203757,-0.0188478080638,-0.02461399475,0.0218385666848,0.0306022451991,0.0365426485434,0.0386334250056,0.0386334250056,0.0386334250056,0.0386334250056,0.0386334250056,0.0386334250056,0.0304675730132,0.0202141002556,0.0202141002556,0.00531951950945,0.00896035398083,0.00531951950945,-0.00335073624526,-0.00335073624526,0.000550949844962,0.000550949844962,-0.00335073624526,-0.00335073624526,-0.00335073624526)
R_hpd_M95=c(-0.496667444838, -0.496667444838,0.279347169185,0.279347169185,0.279347169185,0.27598214034,0.153889346206,0.0232693841438,0.0248823143824,0.0248823143824,0.0248823143824,0.0248823143824,0.0241815790497,0.0241815790497,0.0241815790497,0.0241815790497,0.0518166813514,0.0882844162771,0.0882844162771,0.100808322402,0.100808322402,0.107839203707,0.100808322402,0.103009323159,0.107839203707,0.107839203707,0.107839203707,0.107839203707,0.103009323159,0.116980759635,0.18195855686,0.299330188332,0.295146767731,0.299330188332,0.313422234802,0.320394539843,0.320394539843,0.320394539843,0.320394539843,0.324252128981,0.320394539843,0.311208327707,0.301159299764,0.287984474869,0.287512639551,0.287512639551,0.272449307187,0.272449307187,0.272449307187,0.272449307187,0.272449307187,0.272449307187,0.272449307187)
L_mean=c(0.29408073197, 0.29408073197,0.29408073197,0.29408073197,0.273764552645,0.24065467095,0.0888809862206,0.0759411918442,0.074212531327,0.074212531327,0.074212531327,0.074212531327,0.0741700508323,0.0742913111433,0.0742913111433,0.0745006449615,0.0834526634751,0.12090960582,0.130933997311,0.142252057032,0.151025038873,0.155202445825,0.156497253654,0.157563705225,0.157268037994,0.157268037994,0.158386421122,0.158461328712,0.158794596745,0.161331877344,0.176779025942,0.229110742787,0.243592298456,0.255650677326,0.272390947292,0.273999023352,0.272637224371,0.274654010252,0.275959348561,0.276331269591,0.27526681281,0.268070354906,0.261076743209,0.255493337054,0.251642990291,0.253345997359,0.250702549082,0.249483304565,0.248765705294,0.248472557008,0.249733074,0.249733074,0.249733074)
M_mean=c(1.15648818266, 1.15648818266,0.133058050931,0.133058050931,0.133058050931,0.122642352908,0.113629605943,0.110751085783,0.109968445246,0.108952896229,0.107650166404,0.106707578886,0.106707578886,0.106707578886,0.106707578886,0.106707578886,0.106571926369,0.106434646655,0.106336899807,0.106336899807,0.106336899807,0.106336899807,0.106336899807,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803,0.106037981803)
R_mean=c(-0.862407450692, -0.862407450692,0.16102268104,0.16102268104,0.140706501714,0.118012318042,-0.0247486197221,-0.0348098939384,-0.0357559139192,-0.0347403649021,-0.0334376350774,-0.0324950475588,-0.0325375280534,-0.0324162677424,-0.0324162677424,-0.0322069339243,-0.0231192628942,0.0144749591646,0.0245970975038,0.0359151572247,0.0446881390657,0.0488655460181,0.0501603538463,0.0515257234216,0.0512300561911,0.0512300561911,0.0523484393184,0.0524233469082,0.0527566149413,0.055293895541,0.0707410441384,0.123072760984,0.137554316653,0.149612695523,0.166352965489,0.167961041549,0.166599242568,0.168616028449,0.169921366758,0.170293287787,0.169228831007,0.162032373103,0.155038761406,0.14945535525,0.145605008487,0.147308015555,0.144664567279,0.143445322762,0.142727723491,0.142434575204,0.143695092197,0.143695092197,0.143695092197)
trans=0.5
age=(0:(53-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.470082403551), xlim = c(-55.65,2.65), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.80950313397), xlim = c(-55.65,2.65), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.46051131289, 0.356677341879), xlim = c(-55.65,2.65), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-55.65,2.65), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()